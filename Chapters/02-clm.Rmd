# Complex Linear Regression {#CLR}

## Correlations between complex random variables
When it comes to measuring associations between variables, most frequently analysts use coefficient of correlation. While it is straightforward for real-valued variables, for complex variables this become challenging, because each c.r.v. has two parts, so the correlation needs to take them both into account.

The literature knows two correlation coefficients for complex variables [@ref]: the conjugate and the direct correlation (the latter is known in the literature as "pseudo-correlation"). Their formula are based on the respective covariances and variances (conventional and pseudo discussed in Subsection \@ref(crvSecondMoment)):

1. Conjugate correlation
\begin{equation}
    \rho_{x,y} = \frac{\sigma_{x,y}}{\sigma_x \sigma_y},
    (\#eq:correlationConventional)
\end{equation}

2. Direct correlation
\begin{equation}
    \varrho_{x,y} = \frac{\varsigma_{x,y}}{\varsigma_x \varsigma_y}.
    (\#eq:correlationPseudo)
\end{equation}

Note that both correlations are complex numbers, but they show different things. The conjugate correlation $\rho_{x,y}$ can be written as:
\begin{equation}
    {\rho}_{x,y} = \frac{\sigma_{x_r, y_r} + \sigma_{x_i, y_i} + i (\sigma_{x_i, y_r} - \sigma_{x_r, y_i})}{\sqrt{(\sigma_{x_r}^2 + \sigma_{x_i}^2)(\sigma_{y_r}^2 + \sigma_{y_i}^2)}} .
    (\#eq:correlationConventionalExpanded)
\end{equation}
As can be seen from the formula \@ref(eq:correlationConventionalExpanded), the coefficient becomes a real number only when the cross-covariances between the real and imaginary parts of $x$ and $y$ are equal. In practice, this exotic condition can be met, when the parts for both variables are not correlated. In all the other cases, the resulting correlation coefficient will be a complex number. In general, the real part of the complex correlation $\rho_{x,y}$ shows the average strength of linear relation between respective real and imaginary parts of two complex variables, while the imaginary part of $\rho_{x,y}$ shows the difference between linear relations between the cross values of real and imaginary parts of $x$ and $y$. The coefficient will be equal to zero, when there are no linear relations between the parts of complex variables $x$ and $y$. So, it has some similarities with the conventional correlation coefficient for real numbers, but similarly to the conjugate variance, it obscures the real situation by mixing different things in one number.

The direct correlation can be expanded to:
\begin{equation}
    {\varrho}_{x,y} = \frac{\sigma_{x_r, y_r} - \sigma_{x_i, y_i} + i (\sigma_{x_i, y_r} + \sigma_{x_r, y_i})}{\sqrt{(\sigma_{x_r}^2 - \sigma_{x_i}^2 + i2 \sigma_{x_r,x_i})(\sigma_{y_r}^2 - \sigma_{y_i}^2 + i2 \sigma_{y_r,y_i})}}.
    (\#eq:correlationPseudoExpanded)
\end{equation}
Given that it contains a complex number in the denominator, it is more complicated than the conjugate one.

Father's stuff here.

To get other insights about the direct correlation coefficient, we express its denominator in the exponential form:
\begin{equation}
    {\sqrt{(\sigma_{x_r}^2 - \sigma_{x_i}^2 + i2 \sigma_{x_r,x_i})(\sigma_{y_r}^2 - \sigma_{y_i}^2 + i2 \sigma_{y_r,y_i})}} = R_1^{\frac{1}{2}} e^{i \frac{\phi_1}{2}},
    (\#eq:correlationPseudoExpandedExp01)
\end{equation}
where $R_1 = \sqrt{\left((\sigma_{x_r}^2 - \sigma_{x_i}^2)(\sigma_{y_r}^2 - \sigma_{y_i}^2) - 4 \sigma_{x_r,x_i} \sigma_{y_r,y_i} \right)^2+ 4 \left( (\sigma_{x_r}^2 - \sigma_{x_i}^2) \sigma_{y_r,y_i} + (\sigma_{y_r}^2 - \sigma_{y_i}^2) \sigma_{x_r,x_i} \right)^2}$ and $\phi_1=\arctan \left(\frac{2 \left( (\sigma_{x_r}^2 - \sigma_{x_i}^2) \sigma_{y_r,y_i} + (\sigma_{y_r}^2 - \sigma_{y_i}^2) \sigma_{x_r,x_i} \right)}{(\sigma_{x_r}^2 - \sigma_{x_i}^2)(\sigma_{y_r}^2 - \sigma_{y_i}^2) - 4 \sigma_{x_r,x_i} \sigma_{y_r,y_i}}\right)$, which are obtained by opening the brackets in the square root in the denominator. If we now insert \@ref(eq:correlationPseudoExpandedExp01) in \@ref(eq:correlationPseudoExpanded) and multiply both numerator and denominator by conjugate number to the \@ref(eq:correlationPseudoExpandedExp01) we will get:
\begin{equation}
    {\varrho}_{x,y} = \frac{\left(\sigma_{x_r, y_r} - \sigma_{x_i, y_i} + i (\sigma_{x_i, y_r} + \sigma_{x_r, y_i})\right)e^{-i \frac{\phi_1}{2}}}{R_1^{\frac{1}{2}}}.
    (\#eq:correlationPseudoExpandedExp02)
\end{equation}
Representing the $\sigma_{x_r, y_r} - \sigma_{x_i, y_i} + i (\sigma_{x_i, y_r} + \sigma_{x_r, y_i})$ as $R_2 e^{i \phi_2}$, where $R_2= \sqrt{(\sigma_{x_r, y_r} - \sigma_{x_i, y_i})^2 +  (\sigma_{x_i, y_r} + \sigma_{x_r, y_i})^2}$ and $\phi_2= \arctan \left( \frac{\sigma_{x_i, y_r} + \sigma_{x_r, y_i}}{\sigma_{x_r, y_r} - \sigma_{x_i, y_i}} \right)$, and inserting these values in \@ref(eq:correlationPseudoExpandedExp02) we get:
\begin{equation}
    {\varrho}_{x,y} = \frac{R_2}{\sqrt{R_1}} e^{i \left(\phi_2 - \frac{\phi_1}{2} \right)}.
    (\#eq:correlationPseudoExpandedExp03)
\end{equation}

$\phi = \arctan \left( \frac{\sigma_{x_i, y_r} + \sigma_{x_r, y_i}}{\sigma_{x_r, y_r} - \sigma_{x_i, y_i}} \right) - \frac{\arctan \left(\frac{2 \left( (\sigma_{x_r}^2 - \sigma_{x_i}^2) \sigma_{y_r,y_i} + (\sigma_{y_r}^2 - \sigma_{y_i}^2) \sigma_{x_r,x_i} \right)}{(\sigma_{x_r}^2 - \sigma_{x_i}^2)(\sigma_{y_r}^2 - \sigma_{y_i}^2) - 4 \sigma_{x_r,x_i} \sigma_{y_r,y_i}}\right)}{2}$.

$R=\sqrt{\frac{(\sigma_{x_r, y_r} - \sigma_{x_i, y_i})^2 +  (\sigma_{x_i, y_r} + \sigma_{x_r, y_i})^2}{\sqrt{\left((\sigma_{x_r}^2 - \sigma_{x_i}^2)(\sigma_{y_r}^2 - \sigma_{y_i}^2) - 4 \sigma_{x_r,x_i} \sigma_{y_r,y_i} \right)^2+ 4 \left( (\sigma_{x_r}^2 - \sigma_{x_i}^2) \sigma_{y_r,y_i} + (\sigma_{y_r}^2 - \sigma_{y_i}^2) \sigma_{x_r,x_i} \right)^2}}}$


## Simple CLR
### Model formulation
The simple Complex Linear Regression can be written as:
\begin{equation}
    \mathbf{z} = \mathbf{a} + \mathbf{b} \mathbf{x} + \boldsymbol{\epsilon}
    (\#eq:SimpleCLRComplex)
\end{equation}
or
\begin{equation}
    y_r + i y_i = a_0 + i a_1 + (b_0 + i b_1) (x_r + i x_i) + \epsilon_r + i \epsilon_i
    (\#eq:SimpleCLR)
\end{equation}
Given that any complex equation can be represented as a system of two equations, this model can be represented as a system of two linear regressions:
\begin{equation}
    \begin{aligned}
        y_r = & a_0 + b_0 x_r - b_1 x_i + \epsilon_r \\
        y_i = & a_1 + b_0 x_i + b_1 x_r + \epsilon_i
    \end{aligned}
    (\#eq:SimpleCLRSystem)
\end{equation}
This model captures a very specific dynamics between the real and imaginary parts, given that they share the same set of parameters for the slope.

### Estimation
Number of estimated parameters is k, number of degrees of freedom per series is k/2.


### Inference


### Forecasting


## Multiple CLR
### Model formulation 

### Estimation

### Inference

### Diagnostics

### Forecasting

### Examples of application (Production functions)
