# Introduction to random complex variables {#intro}
## Theory of complex variables

This section sets out the basic concepts of the Theory of Complex Variables Functions (TCVF) with some historical overlook of the idea of complex numbers. Hopefully, this will help in understanding the main idea that we will use extensively in the following chapters.

The theory of complex numbers started in 1572 in the small Italian town of Kura. It was in this place and precisely in this year that the manuscript of an Italian mathematician Rafael Bombelli was published. The book was called Algebra. Rafael Bombelli showed in it how to solve the following cubic equation:
\begin{equation}
    x^3 = 15x + 4 .
    (\#eq:BombelliEquation)
\end{equation}
The root of cubic equations at that time was calculated using the formula of Scipione del Ferro. With regards to the task at hand, finding the root should have been carried out as follows:
\begin{equation}
    \begin{aligned}
    x = & \sqrt[3]{\frac{4}{2}+\sqrt{\left(\frac{4}{2}\right)^2 - \left(\frac{15}{3}\right)^3}} + \sqrt[3]{\frac{4}{2}-\sqrt{\left(\frac{4}{2}\right)^2 - \left(\frac{15}{3}\right)^3}} = \\
        & \sqrt[3]{2+\sqrt{-121}} + \sqrt[3]{2-\sqrt{-121}} .
    \end{aligned}
    (\#eq:BombelliSolution)
\end{equation}
As can be seen from equation \@ref(eq:BombelliSolution), there are several square roots, and it follows directly from the right hand side of this equation that to calculate the roots of equation \@ref(eq:BombelliEquation), we need to extract the square root from the negative number, -121. This means that it will not be possible to find a solution to this equation in the domain of real numbers.

This does not mean that equation \@ref(eq:BombelliEquation) does not have a solution. If you represent the problem graphically on a plane then it is easy to see that there is one. But it is impossible to find it arithmetically using the Scipione del Ferro formula, because there is a negative number in the expression on the right-hand side of \@ref(eq:BombelliSolution), and back then, mathematicians were sure that the square root of a negative number does not exist.

The mathematicians of that time struggled to solve this problem, and Rafael Bombelli suggested to ignore the negative sign in the expression (Bombelli, 12). After all, the number -121 can be represented as a product of two numbers: -1 and 121. Then the square root of this number can be written as $\sqrt{-1} \times 11$. So, formula \@ref(eq:BombelliSolution) becomes:
\begin{equation}
    x = \sqrt[3]{2+11\sqrt{-1}} + \sqrt[3]{2-11\sqrt{-1}} .
    (\#eq:BombelliSolutionSqrt)
\end{equation}
Now it is possible to get a solution of the problem, and the root of the cubic equation is $x = 4$.

For a long time, Bombelli's approach was considered by scientists as a convenient mathematical trick. And the square root of minus one was called "magic unit", "vanishing unit", etc. Finally, the term "imaginary unit" was established by Ren√© Descartes in 1637 and any number multiplied by the imaginary unit would be called "imaginary number". Merging a real number with an imaginary number gives another number, which can be considered as a more general to the two, which is called "complex". It can be written as:
\begin{equation}
    z = x+iy ,
    (\#eq:complexNumber)
\end{equation}
where $x$ is the real part, $iy$ is the imaginary part of a complex number, $x$ and $y$ are real numbers and $i$ is the imaginary unit that satisfies the equality:
\begin{equation}
    i^2 = -1 .
    (\#eq:imaginaryUnit)
\end{equation}

With complex numbers, one can perform almost all the same operations as with the real ones. However, taking into account the properties of the imaginary unit, these operations can lead to results that are not common in the domain of real numbers.

The main problem that analysts face when trying to understand a complex number is the complexity of the interpretation of the imaginary part. The main question in this case can be formulated as: Where do imaginary numbers appear in practice? And what is the practical meaning of an imaginary unit? We have heard questions like that many times, and while they are valid, we think that they do not have appropriate answers and divert the analysts from what the modelling with complex variables brings.

We argue that the imaginary unit does not have any practical meaning: neither in economics, nor in sociology, nor in engineering, nor in physics. The imaginary unit is a mathematical rule, and that is all. It is a mathematical abstract that has useful properties. A number $\sqrt{2}$ or $\ln 3$ do not have practical meaning either, but they are useful for modelling purposes and solving applied problems in a variety of disciplines. Similarly, an imaginary unit is convenient for solving a whole class of problems in different areas of application. With the help of the rules specified by conditions \@ref(eq:complexNumber) and \@ref(eq:imaginaryUnit), it is possible to use new mathematical operations, obtain new mathematical results, and create new mathematical models.

Imaginary and complex numbers are mathematical instruments that can help in describing a real-life phenomenon. If a researcher decides to use complex variables for real processes modelling, they will need to predefine the rules according to which one component of a complex process is attributed to the real part, and another one is attributed to the imaginary part of the complex variable. These rules might seem arbitrary, because there is no "true" recipe, according to which the assignment to complex variable parts should be done. The main motivation for them is the efficiency of modelling (such as goodness of fit or forecasting accuracy) and nothing else.

In order to better understand how the modelling with complex variables can be done, we need to better understand how complex variables can be represented and interpreted. A real number represents visually a certain segment on the numerical axis, which has a zero point and a multitude of values from minus infinity to infinity. Any real number is characterized by the distance from zero to the value of that number. Negative numbers are located to the left of zero, while the positive ones are located to the right of it.

A complex number consists of two parts, which can be visualised on the plane with two perpendicular axes, where the real numbers are marked on the horizontal line, and the imaginary ones are on the vertical one. This is shown visually in Figure \@ref(fig:complexPlane) with a complex number $z=x+iy$.

```{r complexPlane, fig.width=4, fig.height=3, fig.cap="Visual presentation of a complex number on the complex plane.", echo=FALSE}
par(mar=c(1,1,1,1), cex=1.25, cex.lab=1/1.25)
plot(c(0,9),c(0,6), type="l",
     xlab="", ylab="",
     xlim=c(0,10), ylim=c(0,8), axes=F,
     yaxt="n", xaxt="n", col="white")
lines(c(0,9), c(6,6), lwd=2, lty=2, col="grey")
lines(c(9,9), c(0,6), lwd=2, lty=2, col="grey")
arrows(0,0,9,6, lwd=2, angle=15)
text(9,6,"z",pos=3)
text(9.3,0,"x",pos=3)
text(0,6.4,"y",pos=4)
abline(h=0,v=0,lty=1)
title(ylab="Imaginary number", line=0)
title(xlab="Real number", line=0)
```

Any point lying on the complex plane in Figure \@ref(fig:complexPlane) characterises a complex number, even if that point lies on the axis of real numbers. In that specific case, we would be talking about a complex number with a zero imaginary part, i.e. $z=x+i0$.

Given that complex numbers can be represented on a plane (in so called Cartesian coordinates), the number \@ref(eq:complexNumber) can be represented in a form of a vector that starts in the origin of coordinates and ends at the point (x, y). Then any complex number can be represented in form of polar coordinates using the magnitude of the vector and its polar angle:
\begin{equation}
    z = x+iy = r (\cos \phi + i \sin \phi),
    (\#eq:complexNumberTrigonometric)
\end{equation}
where r is the magnitude, which is calculated as a Euclidean distance from the origin to the point (x, y) on the plane:
\begin{equation}
    r = \sqrt{x^2 + y^2},
    (\#eq:complexNumberMagnitude)
\end{equation}
and $\phi$ is the angle, which equals to:
\begin{equation}
    \phi = \arctan \frac{y}{x} + 2 \pi l,
    (\#eq:complexNumberAngle)
\end{equation}
where $l$ is an integer number. While depending on a task, $l$ can be set to a positive, a negative number, or a zero, for convenience, we will restrict it to $l=0$, because all the other values will not be useful for the inference in following chapters. The polar angle is sometimes referred to as the argument of a complex number.

Using the magnitude and the polar angle, we can also represent any complex number in the exponential form (which was first proposed by Euler):
\begin{equation}
    z = r e^{i \phi} ,
    (\#eq:complexNumberExponential)
\end{equation}
where $e$ is the Euler's constant. In this form, the positive real number has $\phi=0$, while the negative one has $\phi=\pi$, and all imaginary numbers have an angle dividable by $\frac{\pi}{2}$. So, for example:
\begin{equation*}
    \begin{aligned}
    41 = & 41 e^{i 0} \\
    i41 = & 41 e^{i \frac{\pi}{2}} \\
    -41 = & 41 e^{i \pi} \\
    -i41 = & 41 e^{i \frac{3 \pi}{2}}
    \end{aligned}
\end{equation*}
The multiplication of any complex number by the imaginary unit in this case implies the rotation by $\frac{\pi}{2}$, as shown in Figure \@ref(fig:complexPlaneMultiplication), where a complex variable $z_1 = x_1 + i y_1$ becomes $z_2 = z_1 \times i = x_2 + i y_2$ etc.

```{r complexPlaneMultiplication, fig.width=4, fig.height=4, fig.cap="Multiplication of a number by $i$.", echo=FALSE}
x <- complex(real=9, imaginary=6)
par(mar=c(1,1,1,1), cex=1)
plot(c(0,9),c(0,6), type="l",
     xlab="", ylab="",
     xlim=c(-12,15), ylim=c(-12,15), axes=F,
     yaxt="n", xaxt="n", col="white")
draw.circle(0,0,sqrt(9^2+6^2))
draw.arc(0,0,2,Arg(x),Arg(x)+pi/2, lwd=2, col=2)
text(Re(x),Im(x),TeX("$z_1$"),pos=3)
arrows(0,0,Re(x),Im(x), lwd=2, angle=15, col=1)
text(1,1.5,TeX("$\\frac{\\pi}{2}$"),pos=3, cex=0.8)
x <- x * 1i
draw.arc(0,0,2,Arg(x),Arg(x)+pi/2, lwd=2, col=3)
text(Re(x),Im(x),TeX("$z_2$"),pos=3)
arrows(0,0,Re(x),Im(x), lwd=2, angle=15, col=2)
x <- x * 1i
draw.arc(0,0,2,Arg(x),Arg(x)+pi/2, lwd=2, col=4)
text(Re(x),Im(x),TeX("$z_3$"),pos=1)
arrows(0,0,Re(x),Im(x), lwd=2, angle=15, col=3)
x <- x * 1i
draw.arc(0,0,2,Arg(x),Arg(x)+pi/2, lwd=2, col=1)
text(Re(x),Im(x),TeX("$z_4$"),pos=1)
arrows(0,0,Re(x),Im(x), lwd=2, angle=15, col=4)
abline(h=0,v=0,lty=1)
text(15, -1, "x", cex=1.25)
text(-1, 15, "y", cex=1.25)
```

In a way, any mathematical operation with a complex number implies a change in magnitude and angle of the number, while the multiplication and division by a number with non-zero imaginary part will always lead to the rotation of the number.

Furthermore, given that any complex number can be represented in the exponential form, it can also be visualised on a polar coordinates plane, where the magnitude is marked on the x-axis, and the polar angle is marked on the y-axis. This is shown visually in Figure \@ref(fig:complexPlanePolar).

```{r complexPlanePolar, fig.width=4, fig.height=3, fig.cap="Visual presentation of a complex number in the polar coordinates.", echo=FALSE}
par(mar=c(1,1,1,1), cex=1.25, cex.lab=1/1.25)
plot(0,0, type="p",
     xlab="", ylab="",
     xlim=c(0,12), ylim=c(0,2), axes=F,
     yaxt="n", xaxt="n", col="white")
lines(c(0,abs(9+6i)), c(Arg(9+6i),Arg(9+6i)), lwd=2, lty=2, col="grey")
lines(c(abs(9+6i),abs(9+6i)), c(0,Arg(9+6i)), lwd=2, lty=2, col="grey")
points(abs(9+6i),Arg(9+6i), lwd=2, pch=20)
text(abs(9+6i),Arg(9+6i),"z",pos=3)
text(abs(9+6i)*(1+0.05),0,"r",pos=3)
text(0,Arg(9+6i)*(1+0.15),TeX("\\phi"),pos=4)
abline(h=0,v=0,lty=1)
title(ylab="Polar angle", line=0)
title(xlab="Magnitude", line=0)
```

The usefulness of the polar coordinates presentation becomes apparent when a set of complex numbers is considered, because then in some cases it becomes possible to see some relations that were not obvious on the Cartesian plane. Figure \@ref(fig:complexCartesianvsPolar) shows an example of a complex random variable, for which the real and imaginary parts do not seem to have any obvious linear relation, but the magnitude and the angle have a negative relation.

```{r complexCartesianvsPolar, fig.cap="Comparison of complex variables on .", echo=FALSE}
x <- rnorm(100,100,10)
y <- 1/x*rlnorm(100,0,0.02)
z <- x*exp(y*1i)
par(mar=c(1,1,1,1), cex=1.25, mfcol=c(1,2))
plot(Re(z), Im(z), type="p",
     xlab="", ylab="",
     yaxt="n", xaxt="n")
title(ylab="Imaginary number", line=0)
title(xlab="Real number", line=0)

plot(abs(z),Arg(z), type="p",
     xlab="", ylab="",
     yaxt="n", xaxt="n")
points(abs(9+6i),Arg(9+6i), lwd=2, pch=20)
abline(h=0,v=0,lty=1)
title(ylab="Polar angle", line=0)
title(xlab="Magnitude", line=0)
```

In this case, modelling can be done in the exponential form of complex variables, which might allow capturing complicated non-linear relations between variables.

When it comes to operations with complex numbers, mathematically we will say that two complex numbers are equal to each other if and only if their real and imaginary parts are equal. Unfortunately, given that complex numbers are two dimensional, it is not possible to say in general whether one variable is greater or less than the other. However, we could use the magnitude to compare complex numbers, to say which one lies further away from the origin than the other. In that case, the variable with a larger magnitude could be considered as a greater than the one with the smaller magnitude. While we could compare the polar angles as well, they only tell us something about the rotation of a complex variable. So, two complex numbers in Figure \@ref(fig:complexPlaneCircle) would have the same magnitude, but will have different angles, and it is not possible to say whether one variable is greater than the other in this case -- we would need to devise additional criteria for comparison (e.g. positive numbers are "better" than the negative and/or imaginary ones).

```{r complexPlaneCircle, fig.width=4, fig.height=4, fig.cap="Visual presentation of a complex number on the complex plane.", echo=FALSE}
par(mar=c(1,1,1,1), cex=1.25, cex.lab=1/1.25)
plot(c(0,9),c(0,6), type="l",
     xlab="", ylab="",
     xlim=c(0,12), ylim=c(0,12), axes=F,
     yaxt="n", xaxt="n", col="white")
draw.circle(0,0,sqrt(9^2+6^2))
text(9,6,TeX("$z_1$"),pos=3)
text(6,9,TeX("$z_2$"),pos=3)
text(4.5,3,TeX("$r$"),pos=3)
text(3,4.5,TeX("$r$"),pos=3)
draw.arc(0,0,2,0,atan(6/9), col="grey", lwd=2)
draw.arc(0,0,4,0,atan(9/6), col="grey", lwd=2)
arrows(0,0,9,6, lwd=2, angle=15)
arrows(0,0,6,9, lwd=2, angle=15)
text(2.7,0.1,TeX("$\\phi_1$"),pos=3)
text(4.5,1,TeX("$\\phi_2$"),pos=3)
abline(h=0,v=0,lty=1)
title(ylab="Imaginary number", line=0)
title(xlab="Real number", line=0)
```



